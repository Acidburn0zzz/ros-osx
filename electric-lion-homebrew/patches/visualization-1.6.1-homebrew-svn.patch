Index: wxpropgrid/find_lib
===================================================================
--- wxpropgrid/find_lib	(revision 37894)
+++ wxpropgrid/find_lib	(working copy)
@@ -8,6 +8,18 @@
 from glob import glob
 import platform
 
+try:
+    import wxversion
+    if not wxversion.checkInstalled(['2.8']):
+        if wxversion.checkInstalled(['2.9']):
+            # Propgrid is built-in to wx-2.9
+            sys.exit(0)
+        else:
+            sys.stderr.write("Neither wx-2.8 or wx-2.9 seems to be installed.")
+            sys.exit(-1)
+except ImportError:
+    sys.stderr.write("Could not import wxversion.  Is wxPython installed?\n")
+    sys.exit(-1)
 
 lib_suffix = "so"
 if (sys.platform == "darwin"):
Index: wxpropgrid/Makefile
===================================================================
--- wxpropgrid/Makefile	(revision 37894)
+++ wxpropgrid/Makefile	(working copy)
@@ -1,3 +1,5 @@
+WX_RELEASE := $(shell wx-config --release)
+
 all: installed
 
 VERSION 	= wxpropgrid-1.4.15
@@ -11,14 +13,17 @@
 
 include $(shell rospack find mk)/download_unpack_build.mk
 
-installed: $(SOURCE_DIR)/unpacked
+installed: 
+ifneq ($(WX_RELEASE),2.9) # Do not build if wx-2.9, wxpropgrid is builtin in wx-2.9
+	$(SOURCE_DIR)/unpacked
 	cd $(SOURCE_DIR) && \
-		export CFLAGS='-g -D__NOTWXPYTHON__ -g' && \
-		export CXXFLAGS='-g -D__NOTWXPYTHON__ -g' && \
-		./configure --prefix=$(WXPROPGRID_ROOT)/propgrid_install && \
+		export CFLAGS='-g -D__NOTWXPYTHON__ -g -arch i386 -arch x86_64' && \
+		export CXXFLAGS='-g -D__NOTWXPYTHON__ -g -arch i386 -arch x86_64' && \
+		./configure --prefix=$(WXPROPGRID_ROOT)/propgrid_install --disable-dependency-tracking && \
 		make && \
 		make install
 	touch installed
+endif
 
 clean:
 	-cd $(SOURCE_DIR) && \
Index: rviz/scripts/frame_test.py
===================================================================
--- rviz/scripts/frame_test.py	(revision 37894)
+++ rviz/scripts/frame_test.py	(working copy)
@@ -3,7 +3,7 @@
 import os
 import sys
 
-WXVER = '2.8'
+WXVER = ['2.8', '2.9']
 import wxversion
 if wxversion.checkInstalled(WXVER):
   wxversion.select(WXVER)
Index: rviz/src/rviz/render_panel.h
===================================================================
--- rviz/src/rviz/render_panel.h	(revision 37894)
+++ rviz/src/rviz/render_panel.h	(working copy)
@@ -95,6 +95,13 @@
 
   void setContextMenu( boost::shared_ptr<wxMenu> menu );
   void onContextMenu( wxContextMenuEvent& event );
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5156
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 9 // If wxWidgets 2.9.x
+  void addPendingEvent(const wxEvent&);
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 
 protected:
   // wx Callbacks
Index: rviz/src/rviz/ros_topic_property.h
===================================================================
--- rviz/src/rviz/ros_topic_property.h	(revision 37894)
+++ rviz/src/rviz/ros_topic_property.h	(working copy)
@@ -32,7 +32,14 @@
 
 #include <wx/wx.h>
 #include <wx/propgrid/propgrid.h>
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
+// This header has been consolidated in the wx-2.9 version of wxPropgrid
 #include <wx/propgrid/propdev.h>
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 
 #include <string>
 
Index: rviz/src/rviz/selection_panel.cpp
===================================================================
--- rviz/src/rviz/selection_panel.cpp	(revision 37894)
+++ rviz/src/rviz/selection_panel.cpp	(working copy)
@@ -55,7 +55,14 @@
 
   property_grid_->SetExtraStyle(wxPG_EX_DISABLE_TLP_TRACKING);
   property_grid_->SetCaptionBackgroundColour( wxColour( 4, 89, 127 ) );
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
+  // This function is no longer available in wxPropgrid for wx-2.9
   property_grid_->SetCaptionForegroundColour( *wxWHITE );
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 
   property_grid_->Connect( wxEVT_PG_CHANGING, wxPropertyGridEventHandler( SelectionPanel::onPropertyChanging ), NULL, this );
   property_grid_->Connect( wxEVT_PG_CHANGED, wxPropertyGridEventHandler( SelectionPanel::onPropertyChanged ), NULL, this );
@@ -170,8 +177,16 @@
 
     handler->createProperties(picked, property_manager_);
   }
-
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
   property_grid_->Sort(property_grid_->GetRoot());
+#else
+  // This is the new way to sort a wxPropertyGrid
+  property_grid_->Sort();
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 
   property_grid_->Thaw();
 }
Index: rviz/src/rviz/ros_topic_property.cpp
===================================================================
--- rviz/src/rviz/ros_topic_property.cpp	(revision 37894)
+++ rviz/src/rviz/ros_topic_property.cpp	(working copy)
@@ -76,12 +76,23 @@
 {
   wxString str = m_value.GetString();
 
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
   wxPGCell* cell = GetCell(1);
   if (!cell)
   {
     cell = new wxPGCell(str, wxNullBitmap, wxNullColour, wxNullColour);
     SetCell(1, cell);
   }
+#else
+  // The new API returns a reference not a pointer
+  // and the library automatically creates a cell if one does not exists for you
+  wxPGCell _cell = GetCell(1);
+  wxPGCell* cell = &_cell;
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 
   if (str.IsEmpty())
   {
Index: rviz/src/rviz/splash_screen.cpp
===================================================================
--- rviz/src/rviz/splash_screen.cpp	(revision 37894)
+++ rviz/src/rviz/splash_screen.cpp	(working copy)
@@ -59,8 +59,6 @@
 {
   state_ = state;
   Refresh();
-
-  wxSafeYield(this, true);
 }
 
 void SplashScreen::onPaint(wxPaintEvent& evt)
Index: rviz/src/rviz/tf_frame_property.h
===================================================================
--- rviz/src/rviz/tf_frame_property.h	(revision 37894)
+++ rviz/src/rviz/tf_frame_property.h	(working copy)
@@ -32,7 +32,14 @@
 
 #include <wx/wx.h>
 #include <wx/propgrid/propgrid.h>
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
+// This header has been consolidated in the wx-2.9 version of wxPropgrid
 #include <wx/propgrid/propdev.h>
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 #include <wx/propgrid/editors.h>
 
 #include <string>
Index: rviz/src/rviz/visualization_frame.cpp
===================================================================
--- rviz/src/rviz/visualization_frame.cpp	(revision 37894)
+++ rviz/src/rviz/visualization_frame.cpp	(working copy)
@@ -167,6 +167,9 @@
     final_splash_path = (fs::path(package_path_) / "images/splash.png").file_string();
 #endif
   }
+  // wxImage splash_image;
+  // splash_image.LoadFile(wxString::FromAscii(final_splash_path.c_str()));
+  // splash_ = new SplashScreen(this, wxBitmap(splash_image));
   wxBitmap splash;
   splash.LoadFile(wxString::FromAscii(final_splash_path.c_str()));
   splash_ = new SplashScreen(this, splash);
Index: rviz/src/rviz/tf_frame_property.cpp
===================================================================
--- rviz/src/rviz/tf_frame_property.cpp	(revision 37894)
+++ rviz/src/rviz/tf_frame_property.cpp	(working copy)
@@ -48,9 +48,10 @@
 
 wxPGWindowList TFFramePGEditor::CreateControls(wxPropertyGrid *propgrid, wxPGProperty *property, const wxPoint &pos, const wxSize &size) const
 {
-  property->GetChoices().Clear();
-  property->GetChoices().Add(wxT(FIXED_FRAME_STRING));
-
+  wxPGChoices choices = property->GetChoices();
+  choices.Clear();
+  choices.Add(wxT(FIXED_FRAME_STRING));
+  
   typedef std::vector<std::string> V_string;
   V_string frames;
   FrameManager::instance()->getTFClient()->getFrameStrings( frames );
@@ -66,7 +67,7 @@
       continue;
     }
 
-    property->GetChoices().Add(wxString::FromAscii(frame.c_str()));
+    choices.Add(wxString::FromAscii(frame.c_str()));
   }
 
   return wxPGComboBoxEditor::CreateControls(propgrid, property, pos, size);
Index: rviz/src/rviz/CMakeLists.txt
===================================================================
--- rviz/src/rviz/CMakeLists.txt	(revision 37894)
+++ rviz/src/rviz/CMakeLists.txt	(working copy)
@@ -97,6 +97,10 @@
 target_link_libraries(${PROJECT_NAME} ${wxWidgets_LIBRARIES} ${OGRE_LIBRARIES})
 rosbuild_link_boost(${PROJECT_NAME} thread signals filesystem system program_options)
 
+if(APPLE)
+  set_target_properties(${PROJECT_NAME} PROPERTIES LINK_FLAGS "-undefined dynamic_lookup")
+endif(APPLE)
+
 find_package(PythonLibs REQUIRED)
 include_directories(${PYTHON_INCLUDE_PATH})
 
Index: rviz/src/rviz/render_panel.cpp
===================================================================
--- rviz/src/rviz/render_panel.cpp	(revision 37894)
+++ rviz/src/rviz/render_panel.cpp	(working copy)
@@ -180,4 +180,14 @@
   }
 }
 
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5156
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 9 // If wxWidgets 2.9.x
+void RenderPanel::addPendingEvent(const wxEvent& event) {
+  this->AddPendingEvent(event);
+}
+#endif
+/* END_WX-2.9_COMPAT_CODE */
+
 } // namespace rviz
Index: rviz/src/rviz/displays_panel.cpp
===================================================================
--- rviz/src/rviz/displays_panel.cpp	(revision 37894)
+++ rviz/src/rviz/displays_panel.cpp	(working copy)
@@ -142,7 +142,7 @@
 
   manager_->removeDisplay(displays_[sel]);
   listbox_->Delete(sel);
-  if (sel < listbox_->GetCount())
+  if (sel < (int)(listbox_->GetCount()))
   {
     listbox_->SetSelection(sel);
   }
@@ -173,7 +173,7 @@
 void ManageDisplaysDialog::onMoveDown( wxCommandEvent& event )
 {
   int sel = listbox_->GetSelection();
-  if (sel >= 0 && sel < listbox_->GetCount() - 1)
+  if (sel >= 0 && sel < (int)(listbox_->GetCount()) - 1)
   {
     std::swap(displays_[sel], displays_[sel + 1]);
     listbox_->Insert(listbox_->GetString(sel + 1), sel);
@@ -202,7 +202,14 @@
   property_grid_->Connect( wxEVT_PG_HIGHLIGHTED, wxPropertyGridEventHandler( DisplaysPanel::onPropertyHighlighted ), NULL, this );
 
   property_grid_->SetCaptionBackgroundColour( wxColour( 4, 89, 127 ) );
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
+  // This function is no longer available in wxPropgrid for wx-2.9
   property_grid_->SetCaptionForegroundColour( *wxWHITE );
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 
   help_html_->Connect(wxEVT_COMMAND_HTML_LINK_CLICKED, wxHtmlLinkEventHandler(DisplaysPanel::onLinkClicked), NULL, this);
 
@@ -238,7 +245,16 @@
 void DisplaysPanel::sortDisplays()
 {
   property_grid_->Freeze();
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
   property_grid_->Sort(property_grid_->GetRoot());
+#else
+  // This is the new way to sort a wxPropertyGrid
+  property_grid_->Sort();
+#endif
+/* END_WX-2.9_COMPAT_CODE */
   property_grid_->Refresh();
   property_grid_->Thaw();
 }
@@ -436,12 +452,22 @@
   CategoryPropertyPtr cat = wrapper->getCategory().lock();
   wxPGProperty* property = wrapper->getCategory().lock()->getPGProperty();
 
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
   wxPGCell* cell = property->GetCell( 0 );
   if ( !cell )
   {
     cell = new wxPGCell(*(wxString*)0, wxNullBitmap, wxNullColour, wxNullColour);
     property->SetCell( 0, cell );
   }
+#else
+  // The new API returns a reference not a pointer
+  // and the library automatically creates a cell if one does not exists for you
+  wxPGCell _cell = property->GetCell(0);
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 
   if (!wrapper->isLoaded())
   {
Index: rviz/src/rviz/tool_properties_panel.cpp
===================================================================
--- rviz/src/rviz/tool_properties_panel.cpp	(revision 37894)
+++ rviz/src/rviz/tool_properties_panel.cpp	(working copy)
@@ -64,7 +64,14 @@
 
   property_grid_->SetExtraStyle(wxPG_EX_DISABLE_TLP_TRACKING);
   property_grid_->SetCaptionBackgroundColour( wxColour( 4, 89, 127 ) );
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
+  // This function is no longer available in wxPropgrid for wx-2.9
   property_grid_->SetCaptionForegroundColour( *wxWHITE );
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 
   property_grid_->Connect( wxEVT_PG_CHANGING, wxPropertyGridEventHandler( ToolPropertiesPanel::onPropertyChanging ), NULL, this );
   property_grid_->Connect( wxEVT_PG_CHANGED, wxPropertyGridEventHandler( ToolPropertiesPanel::onPropertyChanged ), NULL, this );
Index: rviz/src/rviz/properties/edit_enum_property.h
===================================================================
--- rviz/src/rviz/properties/edit_enum_property.h	(revision 37894)
+++ rviz/src/rviz/properties/edit_enum_property.h	(working copy)
@@ -32,7 +32,14 @@
 
 #include <wx/wx.h>
 #include <wx/propgrid/propgrid.h>
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
+// This header has been consolidated in the wx-2.9 version of wxPropgrid
 #include <wx/propgrid/propdev.h>
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 #include <wx/propgrid/editors.h>
 
 #include <string>
Index: rviz/src/rviz/properties/property.cpp
===================================================================
--- rviz/src/rviz/properties/property.cpp	(revision 37894)
+++ rviz/src/rviz/properties/property.cpp	(working copy)
@@ -69,16 +69,25 @@
   {
     return;
   }
-
+  
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
   wxPGCell* cell = property->GetCell( column );
   if ( !cell )
   {
     cell = new wxPGCell( *(wxString*)0, wxNullBitmap, *wxLIGHT_GREY, *wxGREEN );
     property->SetCell( column, cell );
   }
-
+#else
+  wxPGCell _cell = property->GetCell( column );
+  wxPGCell* cell = &_cell;
+#endif
+  
   cell->SetFgCol(fg_color);
   cell->SetBgCol(bg_color);
+/* END_WX-2.9_COMPAT_CODE */
 }
 
 void setPropertyToError(wxPGProperty* property, uint32_t column)
@@ -439,13 +448,29 @@
   }
 
   grid_->SetPropertyLabel(top_property_, label);
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
   wxPGCell* cell = top_property_->GetCell( 0 );
+#else
+  // The new API returns a reference not a pointer
+  // and the library automatically creates a cell if one does not exists for you
+  wxPGCell _cell = top_property_->GetCell( 0 );
+  wxPGCell* cell = &_cell;
+#endif
   if ( cell )
   {
     //cell->SetText(label);
   }
-
+  
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
   grid_->Sort(top_property_);
+#else
+  // This is the new way to sort a wxPropertyGrid
+  grid_->Sort();
+#endif
+/* END_WX-2.9_COMPAT_CODE */
 }
 
 StatusLevel StatusProperty::getTopLevelStatus()
@@ -888,7 +913,15 @@
   {
     property_ = grid_->AppendIn( getCategoryPGProperty(parent_), new wxEnumProperty( name_, prefix_ + name_ ) );
     wxPGChoices choices = choices_->Copy();
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
     grid_->SetPropertyChoices(property_, choices);
+#else
+    // This is the new way of doing this
+    property_->SetChoices(choices);
+#endif
 
     if ( !hasSetter() )
     {
@@ -898,7 +931,13 @@
   else
   {
     wxPGChoices choices = choices_->Copy();
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
     grid_->SetPropertyChoices(property_, choices);
+#else
+    // This is the new way of doing this
+    property_->SetChoices(choices);
+#endif
+/* END_WX-2.9_COMPAT_CODE */
     grid_->SetPropertyValue(property_, (long)get());
   }
 
@@ -983,7 +1022,15 @@
     ee_property_ = new EditEnumPGProperty(name_, prefix_ + name_);
     property_ = grid_->AppendIn( getCategoryPGProperty(parent_), ee_property_ );
     wxPGChoices choices = choices_->Copy();
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
     grid_->SetPropertyChoices(property_, choices);
+#else
+    // This is the new way of doing this
+    property_->SetChoices(choices);
+#endif
 
     if ( !hasSetter() )
     {
@@ -993,7 +1040,13 @@
   else
   {
     wxPGChoices choices = choices_->Copy();
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
     grid_->SetPropertyChoices(property_, choices);
+#else
+    // This is the new way of doing this
+    property_->SetChoices(choices);
+#endif
+/* END_WX-2.9_COMPAT_CODE */
     grid_->SetPropertyValue(property_, wxString::FromAscii( get().c_str() ));
   }
 
@@ -1002,7 +1055,15 @@
 
 void EditEnumProperty::readFromGrid()
 {
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
   wxString str = property_->GetValueString();
+#else
+  wxString str = property_->GetValueAsString();
+#endif
+/* END_WX-2.9_COMPAT_CODE */
   set( (const char*)str.mb_str() );
 }
 
@@ -1058,11 +1119,24 @@
   {
     grid_->SetPropertyLabel( property_, wxString::FromAscii( label.c_str() ) );
 
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
     wxPGCell* cell = property_->GetCell( 0 );
     if ( cell )
     {
       //cell->SetText( wxString::FromAscii( label.c_str() ) );
     }
+#else
+    wxPGCell _cell = property_->GetCell( 0 );
+    wxPGCell* cell = &_cell;
+    if ( cell )
+    {
+      //cell->SetText( wxString::FromAscii( label.c_str() ) );
+    }
+#endif
+/* END_WX-2.9_COMPAT_CODE */
   }
 }
 
@@ -1186,10 +1260,19 @@
   if (grid_)
   {
     setPropertyToColors(property_, grid_->GetCaptionForegroundColour(), grid_->GetCaptionBackgroundColour(), 0);
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5157
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
     wxPGCell* cell = property_->GetCell(0);
+#else
+    wxPGCell _cell = property_->GetCell(0);
+    wxPGCell* cell = &_cell;
+#endif
     wxFont font = grid_->GetFont();
     font.SetWeight(wxBOLD);
     cell->SetFont(font);
+/* END_WX-2.9_COMPAT_CODE */
     //setPropertyToColors(property_, grid_->GetCaptionForegroundColour(), grid_->GetCaptionBackgroundColour(), 1);
   }
 }
Index: rviz/src/rviz/properties/edit_enum_property.cpp
===================================================================
--- rviz/src/rviz/properties/edit_enum_property.cpp	(revision 37894)
+++ rviz/src/rviz/properties/edit_enum_property.cpp	(working copy)
@@ -56,7 +56,8 @@
 {
   if (option_cb_)
   {
-    property->GetChoices().Clear();
+    wxPGChoices _choices = property->GetChoices();
+    _choices.Clear();
 
     V_string choices;
     option_cb_(choices);
@@ -70,7 +71,7 @@
         continue;
       }
 
-      property->GetChoices().Add(wxString::FromAscii(choice.c_str()));
+      _choices.Add(wxString::FromAscii(choice.c_str()));
     }
   }
 
Index: rviz/src/rviz/default_plugin/interactive_markers/interactive_marker.cpp
===================================================================
--- rviz/src/rviz/default_plugin/interactive_markers/interactive_marker.cpp	(revision 37894)
+++ rviz/src/rviz/default_plugin/interactive_markers/interactive_marker.cpp	(working copy)
@@ -458,7 +458,15 @@
 
       event.panel->setContextMenu( menu_ );
       wxContextMenuEvent context_event( wxEVT_CONTEXT_MENU, 0, event.event.GetPosition() );
+/* START_WX-2.9_COMPAT_CODE
+This code is related to ticket: https://code.ros.org/trac/ros-pkg/ticket/5156
+*/
+#if wxMAJOR_VERSION == 2 and wxMINOR_VERSION == 8 // If wxWidgets 2.8.x
       event.panel->AddPendingEvent( context_event );
+#else
+      event.panel->addPendingEvent(context_event);
+#endif
+/* END_WX-2.9_COMPAT_CODE */
       last_control_name_ = control_name;
       return true;
     }
